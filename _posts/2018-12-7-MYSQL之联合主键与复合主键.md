---
layout: post
published: true
title:  mysql之联合主键与复合主键
date:   2018-12-7
categories: 数据库
tag:
  - mysql

---
* content
{:toc}

### 前言

1. 复合主键： 就是指你表的主键含有一个以上的字段组成,不使用无业务含义的自增id作为主键

```bash

create table test
(
   name varchar(19),
   id number,
   value varchar(10),
   primary key (name,id)
)
```

上面的name和id字段组合起来就是你test表的复合主键 ,它的出现是因为你的name字段可能会出现重名，所以要加上ID字段这样就可以保证你记录的唯一性 ,一般情况下，主键的字段长度和字段数目要越少越好

这里就会有一个疑惑?  主键是唯一的索引，那么为何一个表可以创建多个主键呢？



其实“主键是唯一的索引”这话有点歧义的。举个例子，我们在表中创建了一个ID字段，自动增长，并设为主键，这个是没有问题的，因为“主键是唯一的索引”，ID自动增长保证了唯一性，所以可以。


此时，我们再创建一个字段name，类型为varchar，也设置为主键，你会发现，在表的多行中你是可以填写相同的name值的，这岂不是有违“主键是唯一的索引”这句话么？


所以我才说“主键是唯一的索引”是有歧义的。应该是“当表中只有一个主键时，它是唯一的索引；当表中有多个主键时，称为复合主键，复合主键联合保证唯一索引”。


为什么自增长ID已经可以作为唯一标识的主键，为啥还需要复合主键呢。因为，并不是所有的表都要有ID这个字段，比如，我们建一个学生表，没有唯一能标识学生的ID，怎么办呢，学生的名字、年龄、班级都可能重复，无法使用单个字段来唯一标识，这时，我们可以将多个字段设置为主键，形成复合主键，这多个字段联合标识唯一性，其中，某几个主键字段值出现重复是没有问题的，只要不是有多条记录的所有主键值完全一样，就不算重复。



2. 联合主键：顾名思义就是多个主键联合形成一个主键组合(主键原则上是唯一的，别被唯一值所困扰。)  

联合主键的意义：用2个字段(或者多个字段,后面具体都是用2个字段组合)来确定一条记录，说明，这2个字段都不是唯一的，2个字段可以分别重复，这么设置的好处，可以很直观的看到某个重复字段的记录条数。



一个简单的例子 
```

主键A跟主键B组成联合主键 


主键A跟主键B的数据可以完全相同，联合就在于主键A跟主键B形成的联合主键是唯一的。 
下例主键A数据是1，主键B数据也是1，联合主键其实是11，这个11是唯一值，绝对不充许再出现11这个唯一值。(这就是多对多关系) 


主键A数据 主键B数据 
1　　　　　　1 
2　　　　　　2 
3　　　　　　3 


主键A与主键B的联合主键值最多也就是 


11 
12 
13 
21 
22 
23 
31 
32 
33

```

总结: 以我来看复合主键就是含有一个以上的字段组成,如ID+name,ID+phone等,而联合主键要同时是两个表的主题组合起来的。这是和复合主键最大的区别!
